{
    "id": "OSPS-QA-07",
    "meta": {
        "enforce": "OFF",
        "description": "VCS MUST require at least one non-author approval of changes to the primary branch.",
        "controls": [ { "class": "OSPS", "id": "QA-07" } ]
    },
    "tenets": [
        {
            "id": "01-scorecard",
            "code": "outputs.bin_artifacts_checks.all(c, c.score == 10)",
            "outputs": {
                "bin_artifacts_checks": { "code": "has(predicates[0].data.checks) ? predicates[0].data.checks.filter(c, c.name == 'Code-Review' && has(c.score)) : [] " }
            },
            "predicates": {
                "types": ["https://scorecard.dev/result/v0.1"]
            },
            "assessment": {
                "message": "Scorecard reports code review is required for changes"
            },
            "error": {
                "message": "Scorecard detected code review is not enabled in the repository",
                "guidance": "Ensure your repo requires a review from another party for every pull request"
            }
        }
    ]
}
