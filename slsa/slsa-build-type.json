{
    "id": "slsa-build-type",
    "meta": {
        "description": "Ensures an artifact was built from a specified repository and commit"
    },
    "context": {
        "buildPoint" : {
            "required": true,
            "type": "string",
            "description": "Build identifier URI, versioned with @. When unversioned will match any version of the same id"
        }
    },
    "tenets": [
        {
            "predicates": { "types": ["https://slsa.dev/provenance/v1"] },
            "outputs": {
                "buildType": {
                    "code": "has(predicates[0].data.buildDefinition) ? (has(predicates[0].data.buildDefinition.buildType) ? predicates[0].data.buildDefinition.buildType : '' ) : '' "
                }
            },
            "code": "outputs.buildType == context.buildType || outputs.buildType.startsWith(context.buildType + '@')",
            "assessment": { "message": "Expected buildType found: {{ .Outputs.buildType  }}" },
            "error": {
                "message": "BuildType mismatch",
                "guidance": "The attested build type ({{ .Outputs.buildType }}) does not match the expected identifier"
            }
        }
    ]
}
