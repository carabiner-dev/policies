{
    "id": "OSPS-DO-02",
    "meta": {
        "description": "The project MUST provide a mechanism for reporting defects.",
        "assert_mode": "AND",
        "controls": [
            { "class": "OSPS", "id": "DO-02" }
        ]
    },
    "tenets": [               
        {
            "code": "outputs[\"reporting\"]  ",
            "outputs": {
                "reporting": {
                    "code": "\"vulnerability-reporting\" in predicates[0].data.project ? (\"reports-accepted\" in predicates[0].data.project[\"vulnerability-reporting\"] ? predicates[0].data.project[\"vulnerability-reporting\"][\"reports-accepted\"]  : false  ) : false "
                }
            },
            "predicates": {
                "types": ["https://github.com/ossf/security-insights-spec"]
            },
            "assessment": {
                "message": "Project accepts vulnerability reports according to SECURITY_INSIGHTS.yml"
            },
            "error": {
                "message": "No vulnerability reports found in SI",
                "guidance": "Add a security insights file to your repository and define reports-accepted as true under vulnerability-reporting"
            }
        },
        {
            "code": "outputs[\"vulnerability-report-contact\"]  ",
            "outputs": {
                "vulnerability-report-contact": {
                    "code": "\"vulnerability-reporting\" in predicates[0].data.project ? (\"contact\" in predicates[0].data.project[\"vulnerability-reporting\"]  ) : false "
                }
            },
            "predicates": {
                "types": ["https://github.com/ossf/security-insights-spec"]
            },
            "assessment": {
                "message": "Vulnerability report contact found"
            },
            "error": {
                "message": "No contact information found in SECURITY_INSIGHTS.yml",
                "guidance": "Add contact data in the project's SECURITY_INSIGHTS.yml file, under vulnerability-reporting"
            }
        }
    ]
}
