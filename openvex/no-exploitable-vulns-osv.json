{
    "id": "OPENVEX-NO-EXPLOITABLE-VULNS",
    "meta": {
        "description": "Ensure the project has no exploitable vulnerabilities"

    },
    "transformers": [
        {"id": "internal:vex"}
    ],
    "tenets": [
        {
            "id": "02-osv+vex",
            "code": "outputs.vulnerabilities == null ? true : size(outputs.vulnerabilities) == 0",
            "outputs": {
                "vulnerabilities": {
                    "code": "predicates[0].data.results.map(r, has(r.packages), r.packages.map(p, p.vulnerabilities.map(v, v.id)).flatten()).flatten()"
                }
            },
            "predicates": {
                "types": [
                    "https://ossf.github.io/osv-schema/results@v1.6.7",
                    "https://openvex.dev/ns/v0.2.0"
                ]
            },
            "assessment": {
                "message": "No exploitable vulnerabilities found"
            },
            "error": {
                "message": "Vulnerabilities found in code dependencies",
                "guidance": "A scan of your source code found vulnerabilities. Ensure your dependencies are up to date or issue VEX documents to supress them."
            }
        }
    ]            
}
